# Backend Environment Variables Setup Guide

## CRITICAL: Your .env file needs these values to work!

Create or update your `backend/.env` file with these values:

```env
# Database - REQUIRED
MONGO_URI=mongodb://localhost:27017/babyfiction
# Or if using MongoDB Atlas:
# MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/babyfiction

# Server - REQUIRED
PORT=4000
NODE_ENV=development

# JWT - REQUIRED (generate random strings)
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-12345
JWT_EXPIRE=7d
JWT_REFRESH_SECRET=your-refresh-secret-key-change-this-too-67890
JWT_REFRESH_EXPIRE=30d

# Email (Optional for now - can leave empty)
SMTP_HOST=
SMTP_PORT=
SMTP_USER=
SMTP_PASS=
FROM_EMAIL=noreply@babyfiction.com
FROM_NAME=Baby Fiction

RESEND_API_KEY=
EMAIL_FROM_ADDRESS=noreply@babyfiction.com
EMAIL_FROM_NAME=Baby Fiction

# File Upload
MAX_FILE_SIZE=5242880
UPLOAD_PATH=./uploads

# Frontend
FRONTEND_URL=http://localhost:3000

# PayFast (Optional - for payments)
PAYFAST_MERCHANT_ID=
PAYFAST_MERCHANT_KEY=
PAYFAST_PASSPHRASE=
PAYFAST_MODE=sandbox
PAYFAST_RETURN_URL=http://localhost:3000/payment/success
PAYFAST_CANCEL_URL=http://localhost:3000/payment/cancel
PAYFAST_NOTIFY_URL=http://localhost:4000/api/payment/notify

# Redis (Optional - not required for basic functionality)
REDIS_URL=

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Cloudinary (Optional - for image uploads)
CLOUDINARY_CLOUD_NAME=
CLOUDINARY_API_KEY=
CLOUDINARY_API_SECRET=
CLOUDINARY_UPLOAD_FOLDER=babyfiction
```

## Quick Start Configuration

### Minimum Required Variables (Copy this to your .env file):

```env
MONGO_URI=mongodb://localhost:27017/babyfiction
PORT=4000
NODE_ENV=development
JWT_SECRET=babyfiction-secret-key-2024-change-in-production
JWT_EXPIRE=7d
JWT_REFRESH_SECRET=babyfiction-refresh-secret-2024-change-in-production
JWT_REFRESH_EXPIRE=30d
FRONTEND_URL=http://localhost:3000
MAX_FILE_SIZE=5242880
UPLOAD_PATH=./uploads
FROM_EMAIL=noreply@babyfiction.com
FROM_NAME=Baby Fiction
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

## How to Generate Secure JWT Secrets

In Node.js console or terminal:
```javascript
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

Run this twice to get two different secrets for JWT_SECRET and JWT_REFRESH_SECRET.

## MongoDB Setup

### Option 1: Local MongoDB
1. Install MongoDB on your machine
2. Start MongoDB service
3. Use: `MONGO_URI=mongodb://localhost:27017/babyfiction`

### Option 2: MongoDB Atlas (Cloud - Free)
1. Go to https://www.mongodb.com/cloud/atlas
2. Create a free cluster
3. Get connection string
4. Use: `MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/babyfiction`

## After Setting Up .env

1. Save the .env file
2. Restart your backend server:
   ```bash
   cd backend
   npm start
   ```

3. You should see:
   ```
   ðŸš€ Server running in development mode on port 4000
   ðŸ“Š Health check: http://localhost:4000/api/health
   âœ… MongoDB connected successfully
   ```

## Troubleshooting

### Server won't start?
- Check if all REQUIRED variables are filled
- Make sure MongoDB is running
- Check for typos in variable names

### MongoDB connection error?
- Verify MongoDB is running: `mongod --version`
- Check MONGO_URI format
- For Atlas, check username/password and IP whitelist

### JWT errors?
- Make sure JWT_SECRET is at least 32 characters
- Use different values for JWT_SECRET and JWT_REFRESH_SECRET
